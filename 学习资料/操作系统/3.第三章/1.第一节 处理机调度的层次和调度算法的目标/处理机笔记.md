## 第三章 处理机调度与死锁

**背景** : 多道程序环境下,内存存在着多个进程,其数目往往多于处理机数目.

**问题** :  这就要求系统能**按照某种算法**,动态地将**处理机**分配给处于就绪状态的一个进程,使之执行.

**解决方案** : 通过**处理机调度程序**分配处理机

**处理机调度性能**的好坏,决定了系统吞吐量、资源利用率、作业周转时间和响应的及时性...因此至关重要.

---

### 1.处理机调度的层次和调度算法的目标

多道程序系统中,**调度的实质是一种资源分配**

处理机调度算法 : 处理机分配策略规定的**处理机分配算法.**

Ps : 多道批处理系统 : 一个作业从提交到执行至完成,可能经历多级处理机的调度

#### 1.处理机调度的层次

##### 1.高级调度

​		又称为**长程调度**或**作业调度.**调度对象是**作业**..

​		主要功能 : 根据某种算法,决定将外存上处于后备队列的哪几个作业调入内存,为之创建进程,分配资源,放入就绪队列.

​		应用场景 : 主要用于多道批处理系统,分时和实时系统中不设置高级调度.

##### 2.低级调度 运行频率最高

​		又称为**进程调度**或**短程调度.**调度对象是**进程(**或内核支持进程)

​		主要功能 : 根据某种算法,决定就绪队列中的哪个进程应获得处理机,并由**分派程序**将处理机分配给选中的进程.

​		应用场景 : 进程调度是最基本的一种调度,在多道批处理、分时、实时三种类型的OS中,都必须配置这级调度.

​		》 算法不宜太复杂

##### 3.中级调度

​		又称为**内存调度**.

​		主要目的 : **提高内存利用率和系统吞吐量**.为此,将**暂时不能运行的进程,调至外存等待**,此时的状态称为**就绪驻外存状态**(挂起状态).当它们具备运行条件且内存又稍有空闲时,由**中级调度决定**,把符合要求的挂起进程**调入内存中**,并改为就绪状态.挂在就绪队列上等待.

​		中级调度实际就是**存储器管理的对换功能**.

#### 2.处理机调度算法的目标

操作系统的类型和设计目标 决定了如何选择调度方式和算法

##### 1.处理机调度算法的共同目标

1. 资源利用率
   1. 为提高资源利用率,应使系统中的处理机和其他所有资源都尽可能保持忙绿.
   2. 处理机利用率 : $CPU的利用率 = \frac{CPU有效工作时间}{CPU有效工作时间+CPU空闲等待时间}$
2. 公平性
   1. 合理的CPU时间.不会发生进程饥饿现象
   2. 相同类型 相同服务. 不同类型,不同服务
3. 平衡性
   1. 为使系统中的CPU和各种外部设备都能经常处于忙碌状态,调度算法应尽可能保持系统资源使用的平衡性
4. 策略强制执行
   1. 对所制定的策略其中包括安全策略.只要需要,就必须予以准确地执行,即使会造成某些工作的延迟也要执行.

##### 2.批处理系统的目标

1. 平均周转时间短
   1. 周转时间 : 作业提交给系统开始,到作业完成的时间
      1. 作业在**外存后备队列**上等待调度的时间
      2. 进程在**就绪队列**上等待进程调度的时间
      3. 进程在**CPU上执行**的时间
      4. 进程**等待I/O操作**完成的时间
   2. 为了进一步反应调度的性能,清晰描述各进程在其周转时间,等待和执行时间的具体分配状况.使用了带权周转时间.     $W = \frac{T(作业的周转时间)}{T_s(系统为它提供服务的时间)}$
2. 系统吞吐量高
   1. 吞吐量是指在单位时间内系统所完成的作业数,因而与批处理作业的平均长度有关.
3. 处理机利用率高

这些目标是存在一定矛盾的,系统吞吐量高要求短作业,处理机利用率高要求计算量大的作业.

##### 3.分时系统的目标

1. 响应速度快
   1. 键盘输入到显示的时间
2. 均衡性
   1. 系统响应时间的快慢应与用户所请求服务的复杂性相适应

##### 4.实时系统的目标

1. 截止时间的保证
   1. HRT任务,必须确保截止时间
   2. SRT,基本上要保证截止时间
2. 可预测性

